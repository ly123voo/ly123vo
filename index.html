<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>阿拉来抢购（定时没修）</title><style>body{font-family:Arial,sans-serif;background-color:#f0f0f0;text-align:center;padding:20px}.container{background-color:#fff;padding:20px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.1);max-width:600px;margin:auto}input,textarea,button{width:100%;padding:10px;margin:10px 0;border:1px solid #ccc;border-radius:5px}button{background-color:#28a745;color:#fff;cursor:pointer}button:hover{background-color:#218838}.history{margin-top:20px;text-align:left}.history-item{background-color:#e9ecef;margin:10px 0;padding:10px;border-radius:5px;cursor:pointer}.history-item pre{display:none;margin:0;padding:10px;background-color:#fff;border:1px solid #ccc;border-radius:5px}.time-display{margin-top:10px;font-size:1.2em}</style></head><body><div class="container"><h1>阿拉来通杀</h1><div class="form-group"><input type="text" id="interval" placeholder="循环间隔时间（毫秒）"><input type="text" id="startTime" placeholder="定时启动时间（格式: HH:MM:SS:SSS）"><div id="authorizationContainer"><input type="text" class="authorization" placeholder="Authorization令牌"></div><button id="addAuthorizationButton">加一个账户</button><button id="extractAndReplaceButton">提取并替换</button><button id="scheduleButton">定时启动</button><button id="startButton">立即抢购</button><button id="stopButton">结束抢购</button></div><div id="response" style="margin-top: 20px;"></div><div class="history" id="history"></div><div class="time-display" id="timeDisplay"></div></div><script>let f;let h=false;let i;let j={};let k;async function l(){try{const a=await fetch("https://worldtimeapi.org/api/timezone/Asia/Shanghai");if(a.ok){const b=await a.json();return new Date(b.datetime)}else{console.error("无法获取北京时间");return new Date()}}catch(c){console.error("请求错误:",c);return new Date()}}async function m(){k=await l()}function n(){k.setMilliseconds(k.getMilliseconds()+500);const a=document.getElementById("timeDisplay");a.textContent=`北京时间: ${k.toLocaleString("zh-CN",{hour12:false})}`}async function o(a,b,c){try{const d=await fetch(a,{method:"POST",headers:b,body:JSON.stringify(c),timeout:1e4});if(d.ok){const e=await d.text();const f=e.match(/CachePrefix([^\s]{51})/);if(f){return f[1]}else{console.log("未找到匹配的字符串");return null}}else{console.log("POST请求失败，状态码:",d.status);return null}}catch(g){console.log("请求错误:",g);return null}}async function p(a,b,c){try{const d=new URL(a);d.search=new URLSearchParams(c).toString();const e=await fetch(d,{method:"GET",headers:b,timeout:1e4});if(e.ok){return await e.text()}else{console.log("GET请求失败，状态码:",e.status);return null}}catch(f){console.log("请求错误:",f);return null}}async function q(){const a="https://gateway.allxf.top/lootactivityapi/OpenService/v1/Activity/QueueReceiveLootActivity";const b=Array.from(document.getElementsByClassName("authorization")).map(c=>c.value);const d=b.map(async e=>{const f={Host:"gateway.allxf.top",Authorization:e,"Content-Type":"application/json;charset=UTF-8",Referer:"https://m.allxf.top/"};const g={LootActivitySessionID:800133,LootActivitySessionPrizeID:401145,BeaconVerifyParam:[]};const h=await o(a,f,g);if(h){j[e]=`LootActivity:QueueReceive:CachePrefix${h}`;alert("提取成功，有效期约3分钟")}else{alert("提取失败")}});await Promise.all(d)}async function r(a,b){if(!h)return;const c="https://gateway.allxf.top/lootactivityapi/OpenService/v1/Activity/GetQueueReceiveLootActivityResult";const d=b.map(async e=>{const f={Host:"gateway.allxf.top",Authorization:e,"Content-Type":"application/json;charset=UTF-8",Accept:"application/json, text/plain, */*"};while(h){try{const g=j[e];const i={QueueReceiveKey:g};const k=await p(c,f,i);if(k){const l=new Date().toLocaleString("zh-CN",{hour12:false});const m=`${l}\n${k}`;document.getElementById("response").innerHTML=`<pre>${m}</pre>`;s(m);t(k)}}catch(n){console.error("请求错误:",n)}await new Promise(u=>setTimeout(u,a))}});await Promise.all(d)}function v(){if(h)return;h=true;const a=parseInt(document.getElementById("interval").value);const b=Array.from(document.getElementsByClassName("authorization")).map(c=>c.value);r(a,b)}async function w(){if(h)return;h=true;const a=parseInt(document.getElementById("interval").value);const b=Array.from(document.getElementsByClassName("authorization")).map(c=>c.value);const d=document.getElementById("startTime").value;const[e,f,g,i]=d.split(":").map(Number);const j=await l();const k=new Date(j.getFullYear(),j.getMonth(),j.getDate(),e,f,g,i);if(k<j)k.setDate(k.getDate()+1);const m=k-j;i=setTimeout(()=>{m();v()},m)}function x(){h=false;clearTimeout(i);document.getElementById("response").innerHTML="抢购已停止"}function s(a){const b=document.getElementById("history");const c=document.createElement("div");c.className="history-item";c.innerHTML=`<pre>${a}</pre>`;c.addEventListener("click",()=>{c.querySelector("pre").style.display=c.querySelector("pre").style.display==="none"?"block":"none"});b.appendChild(c)}function t(a){}document.getElementById("addAuthorizationButton").addEventListener("click",()=>{const a=document.getElementById("authorizationContainer");const b=document.createElement("input");b.type="text";b.className="authorization";b.placeholder="Authorization令牌";a.appendChild(b)});document.getElementById("extractAndReplaceButton").addEventListener("click",q);document.getElementById("scheduleButton").addEventListener("click",w);document.getElementById("startButton").addEventListener("click",v);document.getElementById("stopButton").addEventListener("click",x);setInterval(n,500);</script></body></html>